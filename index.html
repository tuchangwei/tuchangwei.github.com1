
<!DOCTYPE HTML>

<html>

<head>
	<meta charset="utf-8">
	<title>Vale's Blog</title>
	<meta name="author" content="Vale T.">

	
	<meta name="description" content="Sep 16th, 2013 Sub-Project How to Import One Project to Another One in Xcode. Due to user needs, I have to import one project to another one as a &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="Vale's Blog" type="application/atom+xml">
	
	<link rel="canonical" href="http://tuchangwei.github.io/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">
	<script src="/javascripts/md5.js"></script>
	<script type="text/javascript">
			document.write("<img src='http://www.gravatar.com/avatar/" + MD5("tcwliphone@gmail.com") + "?s=160' alt='Profile Picture' style='width: 160px;' />");
	</script>
</div>
<hgroup>
  <h1><a href="/">Vale's Blog</a></h1>
  
    <h2>iOS Developer, Dad, Freelancer.</h2>
  
</hgroup>

<nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>


<section class="aboutme">
  <p>
    In the world, we play the role of Party A or Party B frequently, but the timeless thing is our sincerity given to others, in return, will be treat sincerely.
  </p>
</section>
</nav>
<nav id="sub-nav">
	<div class="social">
		
				<a class="weibo" href="http://www.weibo.com/thankforyou" title="Weibo">Weibo</a>
		
		
		<a class="facebook" href="http://www.facebook.com/tu.vale.75" title="Facebook">Facebook</a>
		
		
		
		<a class="twitter" href="http://twitter.com/valetu1988" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/tuchangwei" title="GitHub">GitHub</a>
		
		
		
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner">
<div itemscope itemtype="http://schema.org/Blog">


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-09-16T21:42:00+08:00" data-updated="true" itemprop="datePublished">Sep 16<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/sub-project/'>Sub-Project</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/09/16/how-to-import-one-project-to-another-one-in-xcode/" itemprop="url">How to Import One Project to Another One in Xcode.</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>Due to user needs, I have to import one project to another one as a sub-project. The final result should be like the following picture.</p>

<p><img src="http://farm4.staticflickr.com/3803/9773083175_1c842daf5c.jpg"></p>

<p>It is not easy to do this. We need some steps.</p>

<ul>
<li>Step 1, Add &ldquo;iPadBrakeTester.xcodeproj&rdquo; file to BusinessBaseApp project, note that don&rsquo;t choose the &ldquo;Copy items into…&rdquo; checkbox.</li>
</ul>


<p><img src="http://farm6.staticflickr.com/5458/9778845934_895459e499.jpg"></p>

<ul>
<li><p>Step 2, close the iPadBrakeTester project, because you have opened the project in BusinessBaseApp project. If you don&rsquo;t, you can just see the &ldquo;iPadBrakeTester.xcodeproj&rdquo; file and there is no triangle front of it, you will can&rsquo;t expand it.</p></li>
<li><p>Step 3, generate static library. Choose &ldquo;iPadBrakeTester.xcodeproj&rdquo;,add Target. After generating static library, add .m, .h and .framework files to it.</p></li>
</ul>


<p><img src="http://farm4.staticflickr.com/3723/9779659835_52fc37d5b6.jpg"></p>

<p><img src="http://farm8.staticflickr.com/7373/9779677046_8d37cdc81b.jpg"></p>

<ul>
<li>Step 4, generate Bundle, and change the relevant settings to iOS target.</li>
</ul>


<p><img src="http://farm6.staticflickr.com/5337/9779800343_4fac8e3d22.jpg"></p>

<p><img src="http://farm8.staticflickr.com/7311/9779854353_1698045cb4.jpg"></p>

<p>Then, add .xib and iamge files to it, like this:</p>

<p><img src="http://farm4.staticflickr.com/3743/9779815366_2d5c974210.jpg"></p>

<ul>
<li>Step 5, Use static library and Bundle in BusinessBaseApp project.</li>
</ul>


<p><img src="http://farm8.staticflickr.com/7306/9779890825_2a8960475a.jpg"></p>

<p>&ldquo;Target Dependencies&rdquo; means that it needs to rebuild the app object code if code in the dependency changes.</p>

<p>In &ldquo;Link Binary With Libraries&rdquo;,beside adding the static library, you need add the .framework files which you import to the sub-project.</p>

<ul>
<li><p>Step 6, add &ldquo;-ObjC&rdquo; and &ldquo;-all_load&rdquo; flags to &ldquo;Other Linker Flags&rdquo;.</p>

<p>  <strong>-ObjC</strong> because otherwise the linker does not properly load your classes.</p>

<p>  <strong>-all_load</strong> if you have categories in the library, because otherwise those are not loaded.</p></li>
<li><p>Step 7, add the sub-project path to &ldquo;User Header Search Paths&rdquo;, like this:</p></li>
</ul>


<p><img src="http://farm3.staticflickr.com/2843/9780044276_76d5679574.jpg"></p>

<p>Some references:</p>

<p><a href="http://www.cocoanetics.com/2011/12/sub-projects-in-xcode/">Sub-Projects in Xcode</a></p>

<p><a href="http://www.galloway.me.uk/tutorials/ios-library-with-resources/">iOS Library With Resources</a></p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-09-15T09:43:00+08:00" data-updated="true" itemprop="datePublished">Sep 15<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/git/'>Git</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/09/15/some-git-commands/" itemprop="url">Some Git Commands</a></h1>
	<div class="entry-content" itemprop="articleBody">
		

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'> 
</span><span class='line'><span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="n">global</span> <span class="n">color</span><span class="p">.</span><span class="n">ui</span> <span class="n">true</span> <span class="err">#</span> <span class="n">support</span> <span class="n">color</span> <span class="n">global</span><span class="p">.</span>
</span><span class='line'>
</span><span class='line'><span class="n">git</span> <span class="n">reset</span> <span class="o">--</span><span class="n">hard</span> <span class="mi">89428</span><span class="n">ab23e4bd3028c95b4b4064075b3901654a3</span> <span class="err">#</span> <span class="n">reset</span> <span class="n">HEAD</span><span class="p">,</span> <span class="n">index</span> <span class="n">and</span> <span class="n">working</span> <span class="n">tree</span>
</span><span class='line'>
</span><span class='line'><span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">a</span> <span class="err">#</span> <span class="n">List</span> <span class="n">both</span> <span class="n">remote</span><span class="o">-</span><span class="n">tracking</span> <span class="n">branches</span> <span class="n">and</span> <span class="n">local</span> <span class="n">branches</span><span class="p">.</span>
</span><span class='line'>
</span><span class='line'><span class="n">git</span> <span class="n">branch</span> <span class="n">backups</span> <span class="err">#</span> <span class="n">new</span> <span class="n">branch</span> <span class="n">backups</span><span class="p">.</span>
</span><span class='line'>
</span><span class='line'><span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="nl">backups:</span><span class="n">backups</span> <span class="err">#</span> <span class="n">push</span> <span class="n">local</span> <span class="n">branch</span> <span class="n">to</span> <span class="n">remote</span> <span class="n">branch</span><span class="p">.</span>
</span><span class='line'>
</span><span class='line'><span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="o">:</span><span class="n">backups</span> <span class="err">#</span> <span class="n">delete</span> <span class="n">remote</span> <span class="n">branch</span> <span class="n">backups</span><span class="p">.</span>
</span><span class='line'>
</span><span class='line'><span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">d</span> <span class="n">backups</span> <span class="err">#</span> <span class="n">delete</span> <span class="n">local</span> <span class="n">branch</span> <span class="n">backups</span><span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="err">&#39;</span><span class="n">commit</span> <span class="n">data</span><span class="err">&#39;</span> <span class="err">#</span><span class="n">forgin</span> <span class="n">a</span> <span class="n">file</span><span class="p">.</span>
</span><span class='line'>
</span><span class='line'><span class="n">git</span> <span class="n">add</span> <span class="n">another_file</span> <span class="err">#</span> <span class="n">add</span> <span class="n">the</span> <span class="n">file</span><span class="p">.</span>
</span><span class='line'>
</span><span class='line'><span class="n">git</span> <span class="n">commit</span> <span class="o">--</span><span class="n">amend</span> <span class="err">#</span> <span class="n">commit</span> <span class="n">again</span><span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-09-10T21:07:00+08:00" data-updated="true" itemprop="datePublished">Sep 10<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/octopress/'>Octopress</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/09/10/add-sina-weibo-support-for-greyshade-theme-of-octopress/" itemprop="url">Add Sina Weibo Support for Greyshade Theme of Octopress</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>I am not familiar with CSS and ROR until now. It is not easy for me to add Sina Weibo support as the slidebar shows. So let me note it.</p>

<ul>
<li>Firstly, add the following code to &ldquo;octopress/_config.yml&rdquo; file. Note that the weibo_user should be your weibo id, not your nickname.</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Weibo link
</span><span class='line'>weibo_user: thankforyou</span></code></pre></td></tr></table></div></figure>


<p>Behind of the following code:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ----------------------- #
</span><span class='line'>#   3rd Party Settings    #
</span><span class='line'># ----------------------- #</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Secondly, add the &ldquo;weibo.png&rdquo; to &ldquo;octopress/source/images/social&rdquo; dirctory.</li>
<li>Thirdly, add the following code to &ldquo;octopress/sass/parts/_header.scss&rdquo; file.</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&.weibo{
</span><span class='line'>  background: image-url('social/weibo.png') center no-repeat #e32529;
</span><span class='line'>  border: 1px solid #e32529;
</span><span class='line'>  &:hover{
</span><span class='line'>      border: 1px solid darken(#e32529, 10%);
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>In front of the following code:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&.facebook{
</span><span class='line'>  background: image-url('social/facebook.png') center no-repeat #3B5998;
</span><span class='line'>  border: 1px solid #3B5998;
</span><span class='line'>  &:hover{
</span><span class='line'>      border: 1px solid darken(#3B5998, 10%);
</span><span class='line'>  }
</span><span class='line'>}
</span><span class='line'>&.google{
</span><span class='line'>  background: image-url('social/google.png') center no-repeat #C83D20;
</span><span class='line'>  border: 1px solid #C83D20;
</span><span class='line'>  &:hover{
</span><span class='line'>      border: 1px solid darken(#C83D20, 10%);
</span><span class='line'>  }
</span><span class='line'>}
</span><span class='line'>&.twitter{
</span><span class='line'>  background: image-url('social/twitter.png') center no-repeat #55CFF8;
</span><span class='line'>  border: 1px solid #55CFF8;
</span><span class='line'>  &:hover{
</span><span class='line'>      border: 1px solid darken(#55CFF8, 10%);
</span><span class='line'>  }
</span><span class='line'>}
</span><span class='line'>……</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Fourthly, add the following code to &ldquo;octopress/source/_includes/header.html&rdquo; file.</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;a class="weibo" href="http://www.weibo.com/thankforyou" title="Weibo">Weibo&lt;/a></span></code></pre></td></tr></table></div></figure>


<p>Behind of the following code:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>……
</span><span class='line'>&lt;nav id="sub-nav">
</span><span class='line'>  &lt;div class="social"></span></code></pre></td></tr></table></div></figure>


<p>Ok, have done.</p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-09-09T20:59:00+08:00" data-updated="true" itemprop="datePublished">Sep 9<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/autolayout/'>Autolayout</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/09/09/autolayout-in-interface-builder/" itemprop="url">[译]在IB中实现自动布局</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>有关自动布局的其他文章：</p>

<ul>
<li><a href="http://commandshift.co.uk/blog/2013/01/13/autolayout/">Autolayout</a></li>
<li><a href="http://commandshift.co.uk/blog/2013/01/31/visual-format-language-for-autolayout/">Visual format language for autolayout</a></li>
<li><a href="http://commandshift.co.uk/blog/2013/02/20/creating-individual-layout-constraints/">Creating individual constraints</a></li>
</ul>


<p>可怜的界面编辑器。它只能服从命令。苹果告诉它，它必须创建最简单的约束集并且简明的传递给你通过拖拽和调整控件大小所形成的布局中。系统约束集留给你的可能是这样的：</p>

<p><img src="http://static.flickr.com/7422/9710436440_4feab8c718.jpg" width="500" height="205" alt="autolayout_nightmare"></p>

<p>它也不一定非是上面的节奏。</p>

<p>在界面编辑器中快乐写约束的秘密其实很简单：告诉它你想要什么。只是拖拽控件是不够的。</p>

<p>创建一个包含空View的.xib文件(File —> New File —> User Interface —> View)，拖一个label放在View左上方的某个地方。IB将会为你创建一些约束：</p>

<p><img src="http://static.flickr.com/7429/9711179916_c26ce7fea7.jpg" width="500" height="147" alt="label_top_left"></p>

<p>现在，把这个label移动到右下方：</p>

<p><img src="http://static.flickr.com/7336/9707197253_d1a4987a28.jpg" width="500" height="430" alt="label_bottom_right"></p>

<p>IB已经丢掉了之前自动创建的约束，重新创建了一组新约束。这个label现在会有不同的表现——比如说，在3.4寸和4寸iPhone屏上，它将会和屏幕底部保持相同的距离，而不是和屏幕顶部。这可能不是你想要的。</p>

<p>再次将label移回到左上角，开始给IB一些帮助。选择这个label，然后点击右边的“size inspector”图标：</p>

<p><img src="http://farm3.staticflickr.com/2890/9710436938_fe60560e80.jpg" width="500" height="350" alt="size_inspector"></p>

<p>这些影响label的约束出现了。点击这个“Top space to: Superview”约束上的设置图标，选择“Promote to user constraint”。它会改变颜色。兴奋之余，选择同一面板上的“Select and Edit”，把这个固定值改为比如400。这个label将会移动到屏幕底部，但是此时它的位置是相对于View顶部的，而不是底部。</p>

<p>然而，如果你再次拖拽这个label，IB认为你并不关心这个布局，它将会再次为你编造它自己的约束。</p>

<blockquote><p>不要拖拽视图去调整布局，而是创建适当的约束。</p></blockquote>


<p>被你提升或者说编辑的约束叫做用户约束，它在文档浏览器里会显示成蓝色，并且会比较粗。通过拖拽被IB自动增加的约束叫做系统约束，比较细一点。这里你能看出两种不同约束的区别：</p>

<p><img src="http://static.flickr.com/2824/9707197725_e823c0353a.jpg" width="494" height="228" alt="user_and_system_constraints"></p>

<p>拖拽的方法是创建约束的一种方式，但是是最坏的一种方式。因为我们依赖IB为我们做出正确的猜想，什么才是我们想要的。你完全可以控制所有的约束的创建通过“Alignment and Pinning”面板：</p>

<p><img class="left" src="http://static.flickr.com/7404/9710437404_b401a3e7ba.jpg"></p>

<p>在这个Alignment面板中，如果你在编辑器中没有选择多个视图，那除了最下面的两个选项外，其他的选项都是不可选的。注意在每一种约束前面的小图标，这些小图标很好的描叙了对应约束的作用，它们在查看复杂布局的适合很有用。</p>

<p><img class="right" src="http://static.flickr.com/5499/9710437638_02a608ab37.jpg"></p>

<p>在这个“Pinning”面板中，这些“Horizontal”，“Vertical Spacing”，“Widths Equally“和“Heights Equally”选项仅仅在选择多个视图的情况下才可使用。再一次，请注意这些描叙性的图标。</p>

<p>“Pinning”和“Alignment”面板创建的约束相对于拖拽得到的约束，给了你更多的控制权。</p>

<p>对于复杂的布局，确保你在早期有一个清晰的想法将是成功的关键。不如说，你有一组label，你想让它们左边界对齐，并且距离父视图有十个像素点。拖拽将会给你正确的布局，但是不会创建对齐的约束：</p>

<p><img src="http://static.flickr.com/3742/9707198407_af54f82b23.jpg" width="500" height="234" alt="aligned_labels_1"></p>

<p>所有的水平位置的约束都是相对于父视图的。如果你想一起移动这些label，不管是在IB中还是在程序运行中，你都需要改变每一个label的约束。当然，你也可以通过全选这些label，通过这个面板对齐它们的左边界。</p>

<p><img src="http://static.flickr.com/2865/9710438118_606077a97f.jpg"" title="" ></p>

<p>现在有一个单独的间隔约束指向父视图的左边界。编辑这个约束将会移动所有label的位置。</p>

<blockquote><p>对于有清晰想法的布局，要通过“alignment and pinning”面板创建约束，而不是通过拖拽创建。</p></blockquote>


<p>正如我们清楚我们想要什么，我们也必须清楚哪些是我们不想要的。在创建或者提升那些我们关心的约束之后，我们要迅速的移除那些剩余的约束。IB会帮你移除一些，但是你的目的是全部使用你自己创建或提升的用户约束，而不留下系统约束。如果你不这样做，当视图在程序运行中改变，将会因为布局管理器使用那些多余的约束而产生不必要的影响。</p>

<blockquote><p>为了达到100%的用户约束——在你布局中用到的每一个约束，都要保证是你想要的且理解的那个。</p></blockquote>


<p>选择，编辑和删除约束可以在三个不同的地方操作：</p>

<ol>
<li><p>在文档导航里</p>

<p> 在这里，将你的视图命名是非常有帮助的。约束可以在它应用的视图下面找到。注意，一个视图的位置是一个在它父视图上面约束（因为这个约束影响frame），视图的大小则是一个在它自身上面的约束（因为这个约束影响bounds）。</p>

<p> <blockquote><p>在IB中将视图命名对于约束很有帮助。也可以在“identity inspector”中的“Label”处命名。</p></blockquote></p></li>
<li><p>在布局中</p>

<p> 这需要技巧，依赖于展示约束的数量。首先，点击你感兴趣的视图，然后点击那一两个像素宽的指示器。</p></li>
<li><p>在“size inspector”中指定的部分</p>

<p> 这一列包含大小约束和位置约束。“Select and edit”选项和在其他地方选择约束，打开其“attributes inspector”一样。</p>

<p> 在约束的“attributes inspector”选项中，你能够编辑它的优先级。对于大小约束和间隔约束，有小于等于，等于，大于等于和常量等关系。</p></li>
</ol>


<p>通过按照我在文章中突出强调的关键点，你现在应该能够通过IB管理你的约束了。作为总结：</p>

<ul>
<li>不要通过拖拽视图去调整布局，而是编辑合适的约束。</li>
<li>有清晰的目的，使用“alignment and pinning”面板去创建约束而不是通过拖拽。</li>
<li>为了达到100%的用户约束——在你布局中用到的每一个约束，都要保证是你想要的且理解的那个。</li>
<li>在IB中将视图命名对于约束很有帮助。也可以在“identity inspector”中的“Label”处命名。</li>
</ul>


<p>翻译出处：<a href="http://commandshift.co.uk/blog/2013/01/18/autolayout-in-interface-builder/">Autolayout in Interface Builder</a></p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-09-09T08:49:00+08:00" data-updated="true" itemprop="datePublished">Sep 9<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/activities/'>Activities</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/09/09/sep1-7/" itemprop="url">Sep 1-7,2013 All Activities</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<!-- configurable section -->


<script type="text/javascript">
if (typeof rtapi == 'undefined') var rtapi = {}; rtapi.keSu = {};
rtapi.keSu.title = 'All Activities ';
rtapi.keSu.kind = 'sidebar';
rtapi.keSu.styling = { width:300, height:300 };
</script>


<!-- below is required -->


<div id="rtdivkeSu"><p id="rtmsg">RescueTime: <a href="http://www.rescuetime.com/tour"> Project Time Tracking Software</a> 
&amp; Team <a href="http://www.rescuetime.com">Time Management Software</a></p></div>


<script src="https://www.rescuetime.com/anapi/js/embed/B63eSu_COao2zbuL22YAGJtRGAfydngMlhTrcaIY" type="text/javascript"></script>


<script type='text/javascript'>RTAPI.render_all(rtapi);</script>


<!-- a little how-to 
- Paste this into your web page where you want the chart.
- You may have multiple embedded charts on the same page.
- You can change the title, width and height by editing the named properties.
- You can opt for the more verbose full chart by setting .kind to 'default'.
- If you want your own css control, you can add 'rtapi.my_css = true;' before the render function.
- css class names are: 
-   rtdiv : the whole container
-   rttitle : the title, rtchart : the chart, rtfeed : the footer
-->


		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-06-04T22:33:00+08:00" data-updated="true" itemprop="datePublished">Jun 4<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/ios/'>iOS</a>, <a class='category' href='/blog/categories/ipod-library/'>ipod-library</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/06/04/how-to-export-mp3-from-ipod-library/" itemprop="url">How to Export Mp3 From Ipod-library</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>Someday, our leader let me export videos, music and photos from Video, Music and Photos in iPad or iPhone. After looked up some articles, I found it was difficult to export mp3.</p>

<p>But, Nowadays, it came true to export mp3, so every format of ipod-library files can be exported.</p>

<p>Now, See how to do it.</p>

<ul>
<li>first, import some frameworks, such as <code>MobileCoreServices.framework</code>,<code>MediaPlayer.framework</code>,<code>AVFoundation.framework</code></li>
<li><p>second, query the media from ipod-library.</p>

<pre><code>  //request videos and music come from system's Videos and Music 
  NSNumber *videoTypeNum = [NSNumber numberWithInteger:MPMediaTypeAny];

  MPMediaPropertyPredicate *videoPredicate = [MPMediaPropertyPredicate predicateWithValue:videoTypeNum forProperty:MPMediaItemPropertyMediaType];

  MPMediaQuery *videoQuery = [[MPMediaQuery alloc] init];
  [videoQuery addFilterPredicate: videoPredicate];
  _mediaItems = [[videoQuery items] copy];
</code></pre></li>
</ul>


<p>*third, convert MPMediaItem to AVURLAsset, generate file name and file extension, then start export,the format of exported file is &ldquo;MOV&rdquo;.Finally, i need use NSFileManager rename the mov to mp3.</p>

<pre><code> MPMediaItem *mediaItem = [_mediaItems objectAtIndex:_count];

 //get the name of the file.
 NSString *songTitle = [mediaItem valueForProperty: MPMediaItemPropertyTitle];

 //convert MPMediaItem to AVURLAsset.
 AVURLAsset *sset = [AVURLAsset assetWithURL:[mediaItem valueForProperty:MPMediaItemPropertyAssetURL]];

//get the extension of the file.
NSString *fileType = [[[[sset.URL absoluteString] componentsSeparatedByString:@"?"] objectAtIndex:0] pathExtension];

//init export, here you must set "presentName" argument to "AVAssetExportPresetPassthrough". If not, you will can't export mp3 correct.
AVAssetExportSession *export = [[AVAssetExportSession alloc] initWithAsset:sset presetName:AVAssetExportPresetPassthrough];

NSLog(@"export.supportedFileTypes : %@",export.supportedFileTypes);
//export to mov format.
export.outputFileType = @"com.apple.quicktime-movie";

export.shouldOptimizeForNetworkUse = YES;

NSString *extension = ( NSString *)UTTypeCopyPreferredTagWithClass(( CFStringRef)export.outputFileType, kUTTagClassFilenameExtension);

NSLog(@"extension %@",extension);
NSString *path = [NSHomeDirectory() stringByAppendingFormat:@"/Documents/%@.%@",songTitle,extension];

NSURL *outputURL = [NSURL fileURLWithPath:path];
export.outputURL = outputURL;
[export exportAsynchronouslyWithCompletionHandler:^{

   if (export.status == AVAssetExportSessionStatusCompleted)
     {
        //then rename mov format to the original format.
         NSFileManager *manage = [NSFileManager defaultManager];

         NSString *mp3Path = [NSHomeDirectory() stringByAppendingFormat:@"/Documents/%@.%@",songTitle,fileType];

         NSError *error = nil;

         [manage moveItemAtPath:path toPath:mp3Path error:&amp;error];

         NSLog(@"error %@",error);

      }
      else
      {
         NSLog(@"%@",export.error);
      }

}];
</code></pre>

<p>Some points you need notice:</p>

<ul>
<li>when you init AVAssetExportSession object, the &ldquo;presetName&rdquo; argument must be &ldquo;AVAssetExportPresetPassthrough&rdquo;.</li>
<li>The &ldquo;outputFileType&rdquo; may be &ldquo;com.apple.quicktime-movie&rdquo;.</li>
</ul>


<p>So easy, doesn&rsquo;t it? Good night.</p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-05-24T22:49:00+08:00" data-updated="true" itemprop="datePublished">May 24<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/gcd/'>GCD</a>, <a class='category' href='/blog/categories/ios/'>iOS</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/05/24/the-replacement-of-the-semaphore/" itemprop="url">The Replacement of the Semaphore</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>In order to synchronize between threads, i used semaphore in <a href="http://tuchangwei.github.io/blog/2013/03/05/gcdhe-xin-hao-liang/">here</a>. Today, I find a replacement of the semaphore. I think it is more efficient and cool. Now, i note it as follow:</p>

<pre><code>    - (id)initWithLibraryChangedHandler:(void (^)(void))libraryChangedHandler
{
    self = [super init];
    if (self) 
    {
        _assetItems = [NSMutableArray array];
        //Creates a new dispatch queue to which blocks can be submitted.  创建一个新的分发队列用于提交blocks
        _assetItemsQueue = dispatch_queue_create("com.apple.avmovieexporter.assetItemLibraryQueue", DISPATCH_QUEUE_SERIAL);

        _libraryGroup = dispatch_group_create();
        //Returns a well-known global concurrent queue of a given priority level.
        //The well-known global concurrent queues cannot be modified
        //Blocks submitted to these global concurrent queues may be executed concurrently with respect to each other.
        _libraryQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0);

        // Update the table view whenever the library changes
        [[NSNotificationCenter defaultCenter] addObserverForName:ALAssetsLibraryChangedNotification 
                                                          object:nil 
                                                           queue:[NSOperationQueue mainQueue] 
                                                      usingBlock:^(NSNotification *block){
                                                               libraryChangedHandler();
                                                           }];
    }

    return self;
}

- (void)dealloc
{
    dispatch_release(_assetItemsQueue);

    dispatch_release(_libraryQueue);
    dispatch_release(_libraryGroup);

    [[NSNotificationCenter defaultCenter] removeObserver:self name:ALAssetsLibraryChangedNotification object:nil];
}

- (void)loadLibraryWithCompletionBlock:(void (^)(void))completionHandler
{
    // Load content using the Media Library and AssetLibrary APIs, also check for content included in the application bundle
    [self.assetItems removeAllObjects];

    [self buildMediaLibrary];
    [self buildAssetLibrary];
    [self buildApplicationBundleLibrary];


    //Schedules a block object to be submitted to a queue when a group of previously submitted block objects have completed.
    dispatch_group_notify(self.libraryGroup, self.libraryQueue, ^{
        dispatch_async(dispatch_get_main_queue(), ^{
            completionHandler();
        });
    });
}

- (void)addURL:(NSURL *)url
{
    __unsafe_unretained __block VideoLibrary *weakSelf = (VideoLibrary *)self;

    if (url == nil)
        return;

    dispatch_async(self.assetItemsQueue, ^{
        [weakSelf.assetItems addObject:[[AssetItem alloc] initWithURL:url]];
    });
}

#pragma mark - iPod Library

- (void)buildMediaLibrary
{
    __unsafe_unretained __block VideoLibrary *weakSelf = (VideoLibrary *)self;

    //将blocks绑定到libraryGroup，然后放在libraryQueue并发队列中
    dispatch_group_async(self.libraryGroup, self.libraryQueue, ^{
        NSLog(@"started building media library...");

        // Search for video content in the Media Library
#if  __IPHONE_OS_VERSION_MAX_ALLOWED &gt;= 50000
        NSNumber *videoTypeNum = [NSNumber numberWithInteger:MPMediaTypeAnyVideo];
#else
        NSNumber *videoTypeNum = [NSNumber numberWithInteger:(MPMediaTypeAny ^ MPMediaTypeAnyAudio)];
#endif
        MPMediaPropertyPredicate *videoPredicate = [MPMediaPropertyPredicate predicateWithValue:videoTypeNum forProperty:MPMediaItemPropertyMediaType];
        MPMediaQuery *videoQuery = [[MPMediaQuery alloc] init];
        [videoQuery addFilterPredicate: videoPredicate];
        NSArray *items = [videoQuery items];

        for (MPMediaItem *mediaItem in items) 
            [weakSelf addURL:[mediaItem valueForProperty:MPMediaItemPropertyAssetURL]];

        NSLog(@"done building media library...");
    });
}

- (void)buildAssetLibrary
{
    NSLog(@"started building asset library...");

    __unsafe_unretained __block VideoLibrary *weakSelf = (VideoLibrary *)self;
    dispatch_group_enter(weakSelf.libraryGroup);

    ALAssetsLibrary *assetLibrary = [[ALAssetsLibrary alloc] init];

    // Enumerate through all the groups in the Asset Library
    [assetLibrary enumerateGroupsWithTypes:ALAssetsGroupAll 
                                usingBlock:
     ^(ALAssetsGroup *group, BOOL *stop)
     {
         if (group != nil)
         {
             // Filter by groups that contain video
             [group setAssetsFilter:[ALAssetsFilter allVideos]];
             [group enumerateAssetsUsingBlock:
              ^(ALAsset *asset, NSUInteger index, BOOL *stop)
              {
                  if (asset)
                      [weakSelf addURL:[[asset defaultRepresentation] url]];
              }];
         }
         else
         {
             dispatch_group_leave(weakSelf.libraryGroup);
             NSLog(@"done building asset library...");
         }
     }
                              failureBlock:^(NSError *error)
     {
         dispatch_group_leave(weakSelf.libraryGroup);
         NSLog(@"error enumerating AssetLibrary groups %@\n", error);
     }];

}
</code></pre>

<p>The above is used for understanding the whole plot, now you can see the detail:</p>

<pre><code>dispatch_group_notify(self.libraryGroup, self.libraryQueue, ^{
        dispatch_async(dispatch_get_main_queue(), ^{
            completionHandler();
        });
    });
}
</code></pre>

<p>The explain of the <a href="https://developer.apple.com/library/ios/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html">document</a> for the selector is that &ldquo;Schedules a block object to be submitted to a queue when a group of previously submitted block objects have completed.&rdquo; So, we can wait the tasks to complete, then to do something we want. The <code>dispatch_group_enter</code> is cool as well. it can let the block enter the queue and execute as a task associated group.</p>

<p>So, that is all. See you.</p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-04-20T22:07:00+08:00" data-updated="true" itemprop="datePublished">Apr 20<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/localize/'>Localize</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/04/20/localize-string-and-some-utilities/" itemprop="url">Localize Strings Using Some Utilities</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>When release applications, one thing will not be avoided, it is localizing. According to the different user demands, we can divide them into <code>Set language through Settings</code> and <code>Set language inside App</code></p>

<h3>Set language through Settings</h3>

<p>The user demand is easier than another one, when we change language by &ldquo;Settings &ndash;> General &ndash;> international&rdquo;, all applications will restart. So, the .strings file will be loaded again and the language is changed.</p>

<p>Now, let&rsquo;s see how to do it.</p>

<ul>
<li>Use the macro <code>NSLocalizedString(@"user_label_text", nil);</code> to wrap your strings.</li>
<li>Add one kind of language to project as follow, Xcode will generate a forder named <code>language-lproj</code>.
<a href="http://www.flickr.com/photos/tuchangwei/8664824887/" title="Flickr 上 涂 涂 的 412C868B-805A-405A-B5FB-B8F4FB0B96CC"><img src="http://static.flickr.com/8244/8664824887_29f530680e.jpg" width="500" height="284" alt="412C868B-805A-405A-B5FB-B8F4FB0B96CC"></a></li>
<li><p>Use the commend tool <code>genstrings</code> to generate Localizable.strings file.</p>

<pre><code>  genstrings *m -a -o  language-lproj
</code></pre></li>
<li><p>Change the value of the key for different language.</p>

<pre><code>  "user_label_text" = "用户登陆"
</code></pre></li>
</ul>


<p>The game seems over, but it is not true. The genstrings commend either replaces your earily changes, or just follows the changes, does not merge them. This is boring.</p>

<p>So what can i do? You know, we do not be defeated by Ants. Some advice as follows:</p>

<ol>
<li><a href="http://www.delitestudio.com/app/localizable-strings-merge/">Localizable Strings Merge </a> needs $4.99.</li>
<li><a href="AGi18n">AGi18n</a> free and can auto convert strings in xib.</li>
<li><p>my shells.</p>

<p> localizedstring.sh</p>

<pre><code> #!/bin/sh
 echo "input the language you want localize:"
 read language
 echo $language
 desFilePath=$PWD/"$language".lproj/Localizable.strings
 echo des file path is:"$desFilePath"
 if [ ! -e $desFilePath ] ; then
     echo "des file doed not exit, touch it."
     touch $desFilePath
 fi
 tmpDir=$PWD/"$language".lproj/tmp
 tmpFile="$tmpDir"/Localizable.strings
 tmpFile1="$tmpDir"/Localizable1.strings

 rm -rf $tmpDir
 mkdir $tmpDir
 touch $tmpFile1
 find . -name '*.m' | xargs genstrings -macRoman -a -o  $tmpDir
 find . -name '*.mm' | xargs genstrings -macRoman -a -o  $tmpDir
 iconv -f utf-16le  -t utf-8 $tmpFile &gt; $tmpFile1
 chmod 755 loop.sh
 echo  tempfile=$tmpFile1
 echo des=$desFilePath
 ./loop.sh $tmpFile1 $desFilePath
</code></pre>

<p> loop.sh</p>

<pre><code> #!/bin/sh  
 echo 1=$1
 echo 2=$2
 SRC=$1
 DES=$2
 if [ $# -ne 2 ] ; then
     echo Usage: loop.sh src des
     exit 1
 fi
 echo arg OK
 while read line; do
     #line is NULL
 #echo line=$line
     if [ "$line" == "" ] ; then
         echo $line &gt;&gt; $2
         continue
     fi  
     equal=`echo $line|grep "="`
     if [ "$equal" == "" ] ; then
         echo "$line" &gt;&gt; $2
         continue
     fi  
     left=`echo $line| cut -d "=" -f1`
     num=`cat $2|grep "$left"|wc -l`
 #echo num=$num
 #   sleep 1
     if [ $num -eq 0 ]; then
 #   echo "$line insert $2 !!!!!!!!!!!!"
         echo $line &gt;&gt; $2
     fi
 done &lt; $SRC
</code></pre></li>
<li><p><a href="https://github.com/questbeat/Lin">Lin</a> can reduce workload for you.</p>

<p> <img src="https://a248.e.akamai.net/camo.github.com/e089475332f6d71842cf1769d80aaccb14b5e809/687474703a2f2f61646f746f75742e73616b7572612e6e652e6a702f6769746875622f4c696e2f6c696e5f737330312e706e67" alt="" /></p>

<p> <img src="https://a248.e.akamai.net/camo.github.com/6c4fc4630543be9addbb384133d07074866d0a8a/687474703a2f2f61646f746f75742e73616b7572612e6e652e6a702f6769746875622f4c696e2f6c696e5f737330322e706e67" alt="" /></p>

<p> <img src="https://a248.e.akamai.net/camo.github.com/cd16d08d3838fbe83fc72922046ca2e1a03fe7a3/687474703a2f2f61646f746f75742e73616b7572612e6e652e6a702f6769746875622f4c696e2f6c696e5f737330332e706e67" alt="" /></p>

<p> <img src="https://a248.e.akamai.net/camo.github.com/ee79f2b06520190d207530b805dc4e656c396efa/687474703a2f2f61646f746f75742e73616b7572612e6e652e6a702f6769746875622f4c696e2f6c696e5f737330342e706e67" alt="" /></p></li>
</ol>


<h3>Set language inside App</h3>

<p>For this, we need an Object to load stings information real-time.</p>

<p>LanguageHelper.h</p>

<pre><code>#import &lt;Foundation/Foundation.h&gt;
#define CustomLocalizedString(str,comment) [LanguageHelper  get:str alter:nil]
@interface LanguageHelper : NSObject

+(void)initialize;
+(void)setLanguage:(NSString *)lan;
+(NSString *)get:(NSString *)key alter:(NSString *)alternate;

/* @brief 返回当前语言
 * @return 返回当前设置的语言
 */
+(NSString *)currentLanguage;
@end
</code></pre>

<p>LanguageHelper.m</p>

<pre><code>#import "LanguageHelper.h"

@implementation LanguageHelper

static NSBundle *bundle = nil;

+(void)initialize {


    NSUserDefaults* defs = [NSUserDefaults standardUserDefaults];
    NSString *current = @"";
    if ([defs valueForKey:@"userLanguage"])
    {
        current = [defs valueForKey:@"userLanguage"];
    }
    else
    {
        NSArray* languages = [defs objectForKey:@"AppleLanguages"];
        current =[languages objectAtIndex:0];


        NSArray *supportLanguage = [[NSBundle mainBundle] objectForInfoDictionaryKey:@"SupportedLanguage"];
        if (![supportLanguage containsObject:current])
        {
            current = [[NSBundle mainBundle] objectForInfoDictionaryKey:@"DefaultLanguage"];
        }
        [defs setValue:current forKey:@"userLanguage"];
        [defs synchronize];
    }

    [self setLanguage:current];

}
+(void)setLanguage:(NSString *)lan {
    NSLog(@"preferredLang: %@", lan);
    NSString *path = [[ NSBundle mainBundle ] pathForResource:lan ofType:@"lproj" ];
    bundle = [NSBundle bundleWithPath:path];
}

+(NSString *)get:(NSString *)key alter:(NSString *)alternate {
    return [bundle localizedStringForKey:key value:alternate table:nil];
}

+(NSString *)currentLanguage{
    NSUserDefaults* defs = [NSUserDefaults standardUserDefaults];

    return [defs objectForKey:@"userLanguage"];
}

@end
</code></pre>

<p>First, we need replace <code>NSLocalizable(string,commit)</code> to <code>CustomLocalizable(string,commit)</code>, then when the app initializes, we call the method <code>+(void)initialize</code>, when we  change another language, we call the method <code>+(void)setLanguage:(NSString *)lan</code>, then we reload the data on views, the function come true.</p>

<h3>Attention！！！</h3>

<p>Today, the earthquake attracked YaAn. They need our help, you can donate money through <a href="https://love.alipay.com/donate/itemDetail.htm?name=201304201216494301">壹基金</a>, God blesses YaAn and us.</p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-04-10T23:08:00+08:00" data-updated="true" itemprop="datePublished">Apr 10<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/gcd/'>GCD</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/04/10/avoid-retain-cycle-in-block/" itemprop="url">Avoid Retain Cycle in Block</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>Let us make long story short. Please see the codes as following:</p>

<pre><code>- (IBAction)didTapUploadButton:(id)sender
{
  NSString *clientID = @"YOUR_CLIENT_ID_HERE";

  NSString *title = [[self titleTextField] text];
  NSString *description = [[self descriptionTextField] text];

  [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:YES];

  __weak MLViewController *weakSelf = self;
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    UIImage *image = [UIImage imageNamed:@"balloons.jpg"];
    NSData *imageData = UIImageJPEGRepresentation(image, 1.0f);

[MLIMGURUploader uploadPhoto:imageData 
                       title:title 
                 description:description 
               imgurClientID:clientID completionBlock:^(NSString *result) {
  dispatch_async(dispatch_get_main_queue(), ^{
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
    [[weakSelf linkTextView] setText:result];
  });
} failureBlock:^(NSURLResponse *response, NSError *error, NSInteger status) {
  dispatch_async(dispatch_get_main_queue(), ^{
  [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
  [[[UIAlertView alloc] initWithTitle:@"Upload Failed"
                              message:[NSString stringWithFormat:@"%@ (Status code %d)", 
                                               [error localizedDescription], status]
                             delegate:nil
                    cancelButtonTitle:nil
                    otherButtonTitles:@"OK", nil] show];
  });
}];

  });
}
</code></pre>

<p>This is a method for uploading images to <a href="http://imgur.com/">imgur</a>. In the section we can find the codes <code>__weak MLViewController *weakSelf = self;</code> and use it like <code>[[weakSelf linkTextView] setText:result];</code>. So, we have a question: Why we don‘t call self directly,but rather give a weak pointer to point it and use the weak pointer in the block section?</p>

<p>It is what i will say. As we all know, the property of blocks is copy, and the property of self is retain. So, if we use self in the block section, we will get a retain circle. We will never release them. For this reason, we need do it as above.</p>

<p><a href="http://blog.random-ideas.net/?p=160">Here</a> is one reference</p>

<p>Ok, Good night. See you.</p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-04-06T17:18:00+08:00" data-updated="true" itemprop="datePublished">Apr 6<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/mpmovieplayerviewcontroller/'>MPMoviePlayerViewController</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/04/06/how-to-customize-the-ui-of-mpmovieplayerviewcontroller/" itemprop="url">How to Customize the UI of MPMoviePlayerViewController</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>As we all know, the user interface of MPMoviePlayerViewController is ugly. Sometimes, our customer needs a better UI, so let&rsquo;s do it.</p>

<p>Some codes like this:</p>

<pre><code>MPMoviePlayerViewController *player = [[MPMoviePlayerViewController alloc] init];
    player.moviePlayer.contentURL = self.url;
    //here, i set the controlStyle equal to MPMovieControlStyleNone, as a result, we only see the movie view, yet volume button, progress slider, play button as so on.
    player.moviePlayer.controlStyle = MPMovieControlStyleNone;
    player.moviePlayer.view.frame = self.playerViewController.view.frame;
    //next, i create a UIViewController named playerViewController, and insert the moverPlay view to the view of playerViewController.
    [self.playerViewController.view insertSubview:player.moviePlayer.view atIndex:0];
    [player.moviePlayer play];
    [self presentModalViewController:self.playerViewController animated:YES];
</code></pre>

<p>after do that, we need add a view to playerViewController, and set the view is transparent  , we can add custom button on the view to control the move playing. The effect as below:</p>

<p><a href="http://www.flickr.com/photos/tuchangwei/8624399482/" title="Flickr 上 涂 涂 的 Screenshot 2013.04.03 09.32.26"><img src="http://static.flickr.com/8111/8624399482_3801facaf7.jpg" width="500" height="375" alt="Screenshot 2013.04.03 09.32.26"></a></p>

		
		
	</div>

</article>

</div>
<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright &copy; 2013 - Vale T. -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a></footer>
			<script src="/javascripts/slash.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'tuchangwei';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>






		</div>
	</div>
</body>
</html>
